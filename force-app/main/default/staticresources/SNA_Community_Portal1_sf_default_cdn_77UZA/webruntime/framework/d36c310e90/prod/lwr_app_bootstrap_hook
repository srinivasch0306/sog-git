LWR.define("webruntime/connectApiEndpoint/v/1_66_1006-256_0",["exports","@salesforce/community/Id/v/1"],function(e,t){"use strict";function o(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var w=o(t);const E="64.0",c={SEO_PROPERTIES:"seo-properties",SEO_OBJECT_RELATED_URL:"seo-object-related-url"};function g(p,l){const S=l.appVersion||E;switch(p){case c.SEO_PROPERTIES:return`/services/data/v${S}/connect/communities/${w.default}/seo/properties/${l.recordId}`;case c.SEO_OBJECT_RELATED_URL:{const d=encodeURIComponent(l.urlNameOrPath);return`/services/data/v${S}/connect/communities/${w.default}/seo/object-url/${l.scope}/${d}`}default:return null}}e.CONNECT_API_TYPES=c,e.constructApiEndpoint=g,Object.defineProperty(e,"__esModule",{value:!0})}),LWR.define("webruntime/connectApiEndpoint",["exports","webruntime/connectApiEndpoint/v/1_66_1006-256_0"],function(e,t){e.default=t&&typeof t=="object"&&"default"in t?t.default:t,Object.keys(t).forEach(function(o){o==="default"||e.hasOwnProperty(o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})})}),LWR.define("webruntime/utils/v/1_66_1006-256_0",["exports"],function(e){"use strict";function t(u,A){if(!u)throw new Error(A)}function o(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function w(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){const A=Math.random()*16|0;return(u==="x"?A:A&3|8).toString(16)})}function E(u){return typeof u=="string"&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i.test(u)}const c=new RegExp("^([a-z]+://|//)","i");function g(u){return u?c.test(u):!1}const p=new RegExp("/sfsites/c/.+","i");function l(u){return u?p.test(u):!1}function S(u,A){const T=JSON.stringify(A);if(!(window&&window.navigator&&window.navigator.sendBeacon&&window.navigator.sendBeacon(u,T))){const s=new XMLHttpRequest;s.open("POST",u,!0),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s.send(T)}}function d(u){return document?.querySelector(`meta[name="${u}"]`)?.getAttribute("content")||""}function y(){return d("basePath")}function R(){return d("deployTarget")||"CORE"}e.assert=t,e.getBasePathFromMetaTag=y,e.getDeployTargetFromMetaTag=R,e.isAbsoluteURL=g,e.isObject=o,e.isSfdcCoreURL=l,e.sendPayloadToServer=S,e.uuidValidate=E,e.uuidv4=w,Object.defineProperty(e,"__esModule",{value:!0})}),LWR.define("webruntime/utils",["exports","webruntime/utils/v/1_66_1006-256_0"],function(e,t){e.default=t&&typeof t=="object"&&"default"in t?t.default:t,Object.keys(t).forEach(function(o){o==="default"||e.hasOwnProperty(o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})})}),LWR.define("webruntime/guestUuidCookieGenerator/v/1_66_1006-256_0",["exports","webruntime/utils/v/1_66_1006-256_0","webruntime/cookieStore/v/1_66_1006-256_0","@app/guestUuidCookieName/v/1"],function(e,t,o,w){"use strict";function E(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var c=E(w);const g={guestUuidCookieMaxAge:365*24*60*60},{document:p}=globalThis;function l(d){if(!c.default)return;let y=o.getCookie(c.default)||d;t.uuidValidate(y)||(y=t.uuidv4()),typeof window=="undefined"?o.setCookiesFromObject({...o.getAllCookies(),[c.default]:y}):(p.cookie=`${c.default}=${y};Max-Age=${g.guestUuidCookieMaxAge};SameSite=LAX;Path=/`,o.setCookiesFromString(p.cookie),S())}function S(){const d={name:"set-guest-uuid",guestUuid:o.getCookie(c.default)};p.dispatchEvent(new CustomEvent("experience_interaction",{bubbles:!0,composed:!0,detail:d}))}e.setGuestUuidCookie=l,Object.defineProperty(e,"__esModule",{value:!0})}),LWR.define("webruntime/guestUuidCookieGenerator",["exports","webruntime/guestUuidCookieGenerator/v/1_66_1006-256_0"],function(e,t){e.default=t&&typeof t=="object"&&"default"in t?t.default:t,Object.keys(t).forEach(function(o){o==="default"||e.hasOwnProperty(o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})})}),LWR.define("webruntime/cookieStore/v/1_66_1006-256_0",["exports","@app/authenticationCookieName/v/1","@app/guestUuidCookieName/v/1","@salesforce/site/Id/v/1"],function(e,t,o,w){"use strict";function E(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var c=E(t),g=E(o),p=E(w);let l;function S(s){s&&typeof s=="object"&&(l=s)}function d(s){l=x(s)}function y(){const s=T(c.default);return s?s==="1"||s.includes(p.default):!1}function R(){return T(g.default)}function u(){return l}function A(){return Object.entries(l||{}).map(([s,D])=>`${s}=${D}`).join(";")}function T(s){return s?(typeof document!="undefined"&&d(document?.cookie),l&&l[s]):null}function x(s){return s&&typeof s=="string"?s.split(";").reduce((H,_)=>{const[F,I]=_.trim().split("=").map(decodeURIComponent);return H[F]=I,H},{}):null}e.getAllCookies=u,e.getAllCookiesString=A,e.getCookie=T,e.getGuestUuidCookie=R,e.hasSidCookie=y,e.setCookiesFromObject=S,e.setCookiesFromString=d,Object.defineProperty(e,"__esModule",{value:!0})}),LWR.define("webruntime/cookieStore",["exports","webruntime/cookieStore/v/1_66_1006-256_0"],function(e,t){e.default=t&&typeof t=="object"&&"default"in t?t.default:t,Object.keys(t).forEach(function(o){o==="default"||e.hasOwnProperty(o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})})}),LWR.define("webruntime/bootstrapHook/v/1_66_1006-256_0",["exports","lwc/v/8_17_0-alpha_1","webruntime/cookieStore/v/1_66_1006-256_0","webruntime/guestUuidCookieGenerator/v/1_66_1006-256_0","webruntime/routingService/v/1_66_1006-256_0","@communities-webruntime/common/v/1_66_1006-256_0","webruntime/transport/v/1_66_1006-256_0","@salesforce/community/Id/v/1","webruntime/connectApiEndpoint/v/1_66_1006-256_0"],function(e,t,o,w,E,c,g,p,l){"use strict";function S(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var d=S(p);async function y({basePath:r,url:n}){const C=E.getLoginUrl(r,n),b={code:302,location:C};if(!o.hasSidCookie())return console.log("[LoginRedirection] Sid cookie not found, redirecting to login."),b;const f=await(await fetch(`${r}/webruntime/module/@app/user?json`)).json(),m=f.isGuest?"Session has expired, redirection to login.":"Session is still valid. No redirection.";return console.log(`[LoginRedirection] ${m}`),f.isGuest?b:null}class R extends Error{constructor(n,C,b){super(n);this.name="LwrStatusError",this.status=C,this.headers=b}}t.registerDecorators(R,{fields:["name"]});const u=r=>r.status==="rejected",A=r=>r.status==="fulfilled";function T(r){return Object.keys(r||{}).length===0}function x(r,n){const C=typeof n=="string"?n:n.message;throw new Error(`Error in "getServerData" for "${r}"${C?`: ${C}`:""}`,{cause:n})}async function s(r){const{ssrContext:n,dataProviders:C,isPrivate:b,dataSerializers:O,staticTTL:f,dynamicTTL:m,routeMarkup:N}=r,v={...n.query,...n.params};let j;const M=i=>{g.isTooManyRequestsResponse(i)&&(j=new R("Too many requests",429,{"cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE})),g.isDownForMaintenanceResponse(i)&&(j=new R("Down for maintenance",503,{"cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE}))};g.addFetchObserver(M);const L=[];b&&L.push(y(n).then(i=>{i&&(j=new R("Redirect",i.code,{location:i.location||"","cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE}))}).catch(i=>{if(i instanceof Error){const k=`Error in "getServerData" for "getServerLoginRedirect"${i.message?`: ${i.message}`:""}`;throw new Error(k,{cause:i})}})),L.push(...C.map(({preloadData:i,attributes:k,descriptor:h})=>i&&i({...n,attributes:k})?.catch(J=>{x(h,J)})).filter(Boolean));const a=await Promise.allSettled(L).finally(()=>g.removeFetchObserver(M));if(j)throw j;const P=a.filter(u).map(({reason:i})=>i);if(P.length>0)throw new AggregateError(P,`${P.map(({message:i})=>i)}`);const G=(C.length&&Object.keys(O)||[]).reduce((i,k)=>({...i,[k]:O[k]()}),{}),U={...N};let $=[],W=parseInt(m,10);a.filter(A).forEach(({value:i})=>{if(i?.markup)for(const h in i.markup)h==="title"?U[h]=i.markup.title||U[h]:Array.isArray(U[h])?U[h].includes(i.markup[h])||U[h].push(...i.markup[h]):U[h]=[...i.markup[h]];i?.warnings&&($=[...$,...i.warnings]);const k=parseInt(i?.cache?.ttl,10);isNaN(k)||(W=Math.min(W,k))});const V=C.every(({isStatic:i,preloadData:k})=>i||!k)||Object.values(G).every(({data:i}={})=>T(i))?f:Math.min(parseInt(m,10),W).toString();return{props:{url:n.url,routeParams:v,guestUuid:o.getGuestUuidCookie(),initialData:G},markup:U,cache:{ttl:V},warnings:$}}async function D(r,n,C,b){if(!r||!n||!C||!b)return console.error(`[getRecordIdRedirect] one or more params are not defined - routeParams:${JSON.stringify(r)} appVersion:${n} communityId:${C} scope:${b}`),null;const O=l.constructApiEndpoint(l.CONNECT_API_TYPES.SEO_OBJECT_RELATED_URL,{appVersion:n,scope:b,urlNameOrPath:r.urlName||r.urlPath});if(console.log(`[getRecordIdRedirect] START fetch endpoint: ${O}`),O)try{const f=await g.fetch(O);if(console.log(`[getRecordIdRedirect] Returned with status: ${f.status}`),f.ok){const m=await f.json();if(m&&m.recordIdUrl)return m.recordIdUrl}}catch(f){return f instanceof Error&&console.error(`[getRecordIdRedirect] Failed to fetch recordIdUrl: ${f.message}`),null}finally{console.log(`[getRecordIdRedirect] END fetch endpoint: ${O}`)}return null}async function H({basePath:r,params:n},C,b,O){const f=await D(n,C,b,O);return f?{code:301,location:f}:(console.log(`[getRecordIdOrErrorRedirect] basePath: ${r}`),{code:302,location:`${r||""}/error`})}const _=r=>r.status==="rejected";async function F(r){const{ssrContext:n,isPrivate:C,appVersion:b,entityPrefix:O}=r,f=[];let m,N,v;const j=a=>{g.isTooManyRequestsResponse(a)&&(v=new R("Too many requests",429,{"cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE})),g.isDownForMaintenanceResponse(a)&&(v=new R("Down for maintenance",503,{"cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE}))};g.addFetchObserver(j),C&&f.push(y(n).then(a=>{a&&(m=a)}).catch(a=>{if(a instanceof Error){const P=`Error in "getServerData" for "getServerLoginRedirect"${a.message?`: ${a.message}`:""}`;throw new Error(P,{cause:a})}})),f.push(H(n,b,d.default,O).then(a=>{a&&(N=a)}).catch(a=>{throw new Error(`Error in "getServerData" for "getRecordIdOrErrorRedirect"${a.message?`: ${a.message}`:""}`,{cause:a})}));const L=(await Promise.allSettled(f).finally(()=>g.removeFetchObserver(j))).filter(_).map(({reason:a})=>a);if(L.length>0)throw new AggregateError(L,`${L.map(({message:a})=>a)}`);if(v?.status!==429&&v?.status!==503){if(m)v=new R("Redirect",m.code,{location:m.location||"","cache-control":c.CACHE_CONTROL_HEADER_NO_CACHE});else if(N){const{code:a,location:P}=N;v=new R("Redirect",a,{location:P||"","cache-control":a===301?"public, max-age=60":c.CACHE_CONTROL_HEADER_NO_CACHE})}console.log(`[routeAppRedirect] Redirecting to: ${v?.headers?.location}`)}if(v)throw v;return{}}let I=!1;function q(r){I||(t.setHooks({sanitizeHtmlContent(n){return n}}),I=!0),r.addServerDataCallback(({serverData:n})=>{globalThis.CLWR=globalThis.CLWR||{},Object.assign(globalThis.CLWR,{serverData:{initialData:n.initialData||Object.values(n)[0]?.initialData,url:n.url||Object.values(n)[0]?.url,routeParams:n.routeParams||Object.values(n)[0]?.routeParams}}),w.setGuestUuidCookie(n.guestUuid)}),typeof window=="undefined"&&typeof r.addRequestHook=="function"?r.addRequestHook(({cookies:n})=>{o.setCookiesFromObject(n),w.setGuestUuidCookie()}):typeof document!="undefined"&&o.setCookiesFromString(document?.cookie)}function B(r,n){E.initializeServerRouter(n,r)}e.buildServerRouter=B,e.default=q,e.getWebruntimeServerData=s,e.getWebruntimeServerDataForRedirect=F,Object.defineProperty(e,"__esModule",{value:!0})}),LWR.define("webruntime/bootstrapHook",["exports","webruntime/bootstrapHook/v/1_66_1006-256_0"],function(e,t){e.default=t&&typeof t=="object"&&"default"in t?t.default:t,Object.keys(t).forEach(function(o){o==="default"||e.hasOwnProperty(o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})})});
